DEBUG MODE: False
Config file content:
{'model': 'GAT', 'sob': [True, True], 'sob_a': [1.0, 0.5, 1.0], 'a': 0.01, 'opti': 'adamW', 'reg': 'none', 'loss': 'Huber', 'acts': ['tanh', None], 'epochs': 20, 'modelsize': 256, 'batchsize': 32, 'timesize': 32, 'lr': 0.0001, 'split': 0.9, 'device': 'cpu', 'single': True}
20
torch.Size([128, 1, 1, 5])
96 snapshots
torch.Size([32, 1, 5])
96
HNN_maker(
  (q_net): Sequential(
    (0): Linear(in_features=1, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=1, bias=True)
  )
  (net): Sequential(
    (0): GATv2Conv(
      (fc_src): Linear(in_features=2, out_features=256, bias=True)
      (fc_dst): Linear(in_features=2, out_features=256, bias=True)
      (feat_drop): Dropout(p=0.0, inplace=False)
      (attn_drop): Dropout(p=0.0, inplace=False)
      (leaky_relu): LeakyReLU(negative_slope=0.2)
      (activation): Tanh()
    )
    (1): GATv2Conv(
      (fc_src): Linear(in_features=256, out_features=32, bias=True)
      (fc_dst): Linear(in_features=256, out_features=32, bias=True)
      (feat_drop): Dropout(p=0.0, inplace=False)
      (attn_drop): Dropout(p=0.0, inplace=False)
      (leaky_relu): LeakyReLU(negative_slope=0.2)
      (activation): Identity()
    )
  )
)
TRAIN
  0%|          | 0/20 [00:00<?, ?it/s]


100%|██████████| 3/3 [00:13<00:00,  4.23s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 1
LOSS: train: 17.921328 grad: 4.195455  ham: 15.451154 |   test: 17.981503 grad: 3.140664 ham: 16.185068
  5%|▌         | 1/20 [00:14<04:41, 14.81s/it]
 67%|██████▋   | 2/3 [00:10<00:05,  5.09s/it]
100%|██████████| 3/3 [00:13<00:00,  4.32s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 2
LOSS: train: 16.942257 grad: 4.152206  ham: 14.500951 |   test: 17.286411 grad: 3.096171 ham: 15.516022
 10%|█         | 2/20 [00:29<04:28, 14.93s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.11s/it]
100%|██████████| 3/3 [00:13<00:00,  4.26s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 3
LOSS: train: 15.967834 grad: 4.096367  ham: 13.559283 |   test: 16.610128 grad: 3.072458 ham: 14.854301
 15%|█▌        | 3/20 [00:44<04:13, 14.91s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.12s/it]
100%|██████████| 3/3 [00:13<00:00,  4.33s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 4
LOSS: train: 15.038817 grad: 4.029233  ham: 12.671856 |   test: 15.951804 grad: 3.068983 ham: 14.199315
 20%|██        | 4/20 [00:59<03:59, 14.97s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.13s/it]
100%|██████████| 3/3 [00:13<00:00,  4.28s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 5
LOSS: train: 14.030876 grad: 4.019025  ham: 11.669483 |   test: 15.311126 grad: 3.084039 ham: 13.551616
 25%|██▌       | 5/20 [01:14<03:44, 14.96s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.13s/it]
100%|██████████| 3/3 [00:13<00:00,  4.33s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 6
LOSS: train: 13.259501 grad: 3.958761  ham: 10.936217 |   test: 14.683554 grad: 3.115566 ham: 12.907697
 30%|███       | 6/20 [01:29<03:30, 15.00s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.12s/it]
100%|██████████| 3/3 [00:13<00:00,  4.28s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 7
LOSS: train: 12.224599 grad: 3.938231  ham: 9.914310 |   test: 14.069462 grad: 3.160243 ham: 12.269643
 35%|███▌      | 7/20 [01:44<03:14, 14.99s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.14s/it]
100%|██████████| 3/3 [00:13<00:00,  4.34s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 8
LOSS: train: 11.264565 grad: 3.935101  ham: 8.957733 |   test: 13.462533 grad: 3.215214 ham: 11.632590
 40%|████      | 8/20 [01:59<03:00, 15.03s/it]


100%|██████████| 3/3 [00:13<00:00,  4.29s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 9
LOSS: train: 10.370064 grad: 3.937130  ham: 8.061561 |   test: 12.859001 grad: 3.278247 ham: 10.993911
 45%|████▌     | 9/20 [02:14<02:45, 15.02s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.14s/it]
100%|██████████| 3/3 [00:13<00:00,  4.34s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 10
LOSS: train: 9.424932 grad: 3.906432  ham: 7.138338 |   test: 12.262137 grad: 3.347167 ham: 10.358002
 50%|█████     | 10/20 [02:30<02:30, 15.05s/it]


100%|██████████| 3/3 [00:13<00:00,  4.28s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 11
LOSS: train: 8.533296 grad: 3.921948  ham: 6.234707 |   test: 11.822315 grad: 3.418499 ham: 9.877150
 55%|█████▌    | 11/20 [02:44<02:15, 15.03s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.14s/it]
100%|██████████| 3/3 [00:13<00:00,  4.34s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 12
LOSS: train: 8.135852 grad: 3.900330  ham: 5.853132 |   test: 11.633526 grad: 3.483531 ham: 9.650436
 60%|██████    | 12/20 [03:00<02:00, 15.05s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.14s/it]
TEST
Epoch: 13
LOSS: train: 7.940360 grad: 3.932378  ham: 5.635391 |   test: 11.531178 grad: 3.533132 ham: 9.518867
100%|██████████| 1/1 [00:01<00:00,  1.43s/it]
 65%|██████▌   | 13/20 [03:15<01:45, 15.04s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.15s/it]
100%|██████████| 3/3 [00:13<00:00,  4.35s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 14
LOSS: train: 7.882023 grad: 3.921092  ham: 5.585586 |   test: 11.443368 grad: 3.568151 ham: 9.410333
 70%|███████   | 14/20 [03:30<01:30, 15.07s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.14s/it]
TEST
Epoch: 15
LOSS: train: 7.801652 grad: 3.943366  ham: 5.488557 |   test: 11.351343 grad: 3.585933 ham: 9.307894
100%|██████████| 1/1 [00:01<00:00,  1.43s/it]
 75%|███████▌  | 15/20 [03:45<01:15, 15.04s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.15s/it]
100%|██████████| 3/3 [00:13<00:00,  4.35s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 16
LOSS: train: 8.015141 grad: 3.917359  ham: 5.720387 |   test: 11.246140 grad: 3.588741 ham: 9.201375
 80%|████████  | 16/20 [04:00<01:00, 15.07s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.16s/it]
100%|██████████| 1/1 [00:01<00:00,  1.44s/it]
 85%|████████▌ | 17/20 [04:15<00:45, 15.06s/it]
  0%|          | 0/3 [00:00<?, ?it/s]
Epoch: 17
LOSS: train: 7.802078 grad: 3.915084  ham: 5.510156 |   test: 11.117702 grad: 3.576904 ham: 9.080630


 67%|██████▋   | 2/3 [00:10<00:05,  5.16s/it]
100%|██████████| 3/3 [00:13<00:00,  4.35s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 18
LOSS: train: 7.767278 grad: 3.910013  ham: 5.477341 |   test: 10.961473 grad: 3.550951 ham: 8.940829
 90%|█████████ | 18/20 [04:30<00:30, 15.09s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.15s/it]
100%|██████████| 1/1 [00:01<00:00,  1.44s/it]
100%|██████████| 1/1 [00:01<00:00,  1.44s/it]
Epoch: 19
LOSS: train: 7.681437 grad: 3.880483  ham: 5.411777 |   test: 10.773117 grad: 3.512622 ham: 8.776583
 95%|█████████▌| 19/20 [04:45<00:15, 15.06s/it]


 67%|██████▋   | 2/3 [00:10<00:05,  5.15s/it]
100%|██████████| 3/3 [00:13<00:00,  4.30s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 20
LOSS: train: 7.592930 grad: 3.855573  ham: 5.340797 |   test: 10.542068 grad: 3.462886 ham: 8.576747
20
torch.Size([128, 1, 1, 9])
96 snapshots
torch.Size([32, 1, 9])
96
loading prevoius model
HNN_maker(
  (q_net): Sequential(
    (0): Linear(in_features=1, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=1, bias=True)
  )
  (net): Sequential(
    (0): GATv2Conv(
      (fc_src): Linear(in_features=2, out_features=256, bias=True)
      (fc_dst): Linear(in_features=2, out_features=256, bias=True)
      (feat_drop): Dropout(p=0.0, inplace=False)
      (attn_drop): Dropout(p=0.0, inplace=False)
      (leaky_relu): LeakyReLU(negative_slope=0.2)
      (activation): Tanh()
    )
    (1): GATv2Conv(
      (fc_src): Linear(in_features=256, out_features=32, bias=True)
      (fc_dst): Linear(in_features=256, out_features=32, bias=True)
      (feat_drop): Dropout(p=0.0, inplace=False)
      (attn_drop): Dropout(p=0.0, inplace=False)
      (leaky_relu): LeakyReLU(negative_slope=0.2)
      (activation): Identity()
    )
  )
)
100%|██████████| 20/20 [05:00<00:00, 15.03s/it]
  0%|          | 0/20 [00:00<?, ?it/s]


 67%|██████▋   | 2/3 [00:11<00:05,  5.66s/it]
100%|██████████| 1/1 [00:01<00:00,  1.48s/it]
  5%|▌         | 1/20 [00:16<05:10, 16.32s/it]
  0%|          | 0/3 [00:00<?, ?it/s]
Epoch: 1
LOSS: train: 34.303242 grad: 2.495269  ham: 32.867821 |   test: 35.021381 grad: 2.691235 ham: 33.470325


 67%|██████▋   | 2/3 [00:11<00:05,  5.76s/it]
100%|██████████| 3/3 [00:15<00:00,  4.74s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 2
LOSS: train: 31.771286 grad: 2.472880  ham: 30.350723 |   test: 32.208771 grad: 2.608782 ham: 30.706202
 10%|█         | 2/20 [00:32<04:55, 16.43s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.72s/it]
100%|██████████| 3/3 [00:14<00:00,  4.73s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 3
LOSS: train: 29.086168 grad: 2.498913  ham: 27.650152 |   test: 29.403856 grad: 2.572688 ham: 27.927240
 15%|█▌        | 3/20 [00:49<04:39, 16.46s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.81s/it]
TEST
Epoch: 4
LOSS: train: 26.357298 grad: 2.453147  ham: 24.949621 |   test: 26.622669 grad: 2.586807 ham: 25.137342
100%|██████████| 1/1 [00:01<00:00,  1.49s/it]
 20%|██        | 4/20 [01:06<04:24, 16.55s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.73s/it]
100%|██████████| 3/3 [00:14<00:00,  4.73s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 5
LOSS: train: 23.751913 grad: 2.412584  ham: 22.369041 |   test: 23.777946 grad: 2.512007 ham: 22.336769
 25%|██▌       | 5/20 [01:22<04:07, 16.53s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.75s/it]
100%|██████████| 3/3 [00:15<00:00,  4.79s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 6
LOSS: train: 21.231863 grad: 2.447331  ham: 19.827826 |   test: 20.978287 grad: 2.550613 ham: 19.516369
 30%|███       | 6/20 [01:39<03:51, 16.57s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.73s/it]
100%|██████████| 3/3 [00:15<00:00,  4.73s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 7
LOSS: train: 18.410307 grad: 2.418174  ham: 17.024206 |   test: 18.020306 grad: 2.369401 ham: 16.667072
 35%|███▌      | 7/20 [01:55<03:35, 16.55s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.79s/it]
100%|██████████| 3/3 [00:15<00:00,  4.83s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 8
LOSS: train: 15.756363 grad: 2.420061  ham: 14.369153 |   test: 15.218973 grad: 2.498353 ham: 13.790358
 40%|████      | 8/20 [02:12<03:19, 16.62s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.74s/it]
100%|██████████| 3/3 [00:15<00:00,  4.74s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 9
LOSS: train: 12.983955 grad: 2.428576  ham: 11.591156 |   test: 12.198647 grad: 2.309698 ham: 10.880870
 45%|████▌     | 9/20 [02:28<03:02, 16.60s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.78s/it]
100%|██████████| 3/3 [00:15<00:00,  4.77s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 10
LOSS: train: 10.252587 grad: 2.366135  ham: 8.898023 |   test: 9.374701 grad: 2.443193 ham: 7.977967
 50%|█████     | 10/20 [02:45<02:46, 16.61s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.82s/it]
100%|██████████| 1/1 [00:01<00:00,  1.50s/it]
 55%|█████▌    | 11/20 [03:02<02:29, 16.65s/it]
  0%|          | 0/3 [00:00<?, ?it/s]
Epoch: 11
LOSS: train: 7.651781 grad: 2.385171  ham: 6.285446 |   test: 6.506024 grad: 2.318708 ham: 5.184094


 67%|██████▋   | 2/3 [00:11<00:05,  5.78s/it]
100%|██████████| 3/3 [00:15<00:00,  4.77s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 12
LOSS: train: 5.252718 grad: 2.357485  ham: 3.903560 |   test: 4.130119 grad: 2.418724 ham: 2.747088
 60%|██████    | 12/20 [03:19<02:13, 16.65s/it]


100%|██████████| 3/3 [00:15<00:00,  4.79s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 13
LOSS: train: 3.585465 grad: 2.362193  ham: 2.231662 |   test: 2.552812 grad: 2.380474 ham: 1.193410
 65%|██████▌   | 13/20 [03:35<01:56, 16.68s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.79s/it]
100%|██████████| 3/3 [00:15<00:00,  4.78s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 14
LOSS: train: 3.179363 grad: 2.414579  ham: 1.793812 |   test: 3.011144 grad: 2.237155 ham: 1.732889
 70%|███████   | 14/20 [03:52<01:40, 16.68s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.85s/it]
100%|██████████| 3/3 [00:15<00:00,  4.81s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 15
LOSS: train: 4.064849 grad: 2.380028  ham: 2.701258 |   test: 3.708988 grad: 2.411347 ham: 2.328161
 75%|███████▌  | 15/20 [04:09<01:23, 16.71s/it]


100%|██████████| 3/3 [00:15<00:00,  4.76s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 16
LOSS: train: 4.239925 grad: 2.370902  ham: 2.879771 |   test: 3.037362 grad: 2.213723 ham: 1.774640
 80%|████████  | 16/20 [04:25<01:06, 16.68s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.84s/it]
100%|██████████| 3/3 [00:15<00:00,  4.80s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 17
LOSS: train: 3.435797 grad: 2.326193  ham: 2.103953 |   test: 2.301599 grad: 2.256603 ham: 1.017028
 85%|████████▌ | 17/20 [04:42<00:50, 16.69s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.77s/it]
100%|██████████| 3/3 [00:15<00:00,  4.76s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 18
LOSS: train: 2.863802 grad: 2.370953  ham: 1.504353 |   test: 2.428091 grad: 2.237185 ham: 1.153929
 90%|█████████ | 18/20 [04:59<00:33, 16.67s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.86s/it]
TEST
Epoch: 19
LOSS: train: 2.859951 grad: 2.361497  ham: 1.507459 |   test: 2.751832 grad: 2.268637 ham: 1.460171
100%|██████████| 1/1 [00:01<00:00,  1.50s/it]
 95%|█████████▌| 19/20 [05:15<00:16, 16.70s/it]


 67%|██████▋   | 2/3 [00:11<00:05,  5.77s/it]
100%|██████████| 3/3 [00:15<00:00,  4.76s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 20
LOSS: train: 3.033037 grad: 2.362147  ham: 1.678407 |   test: 2.902594 grad: 2.356001 ham: 1.555515
20
torch.Size([128, 1, 1, 13])
96 snapshots
torch.Size([32, 1, 13])
96
loading prevoius model
HNN_maker(
  (q_net): Sequential(
    (0): Linear(in_features=1, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=1, bias=True)
  )
  (net): Sequential(
    (0): GATv2Conv(
      (fc_src): Linear(in_features=2, out_features=256, bias=True)
      (fc_dst): Linear(in_features=2, out_features=256, bias=True)
      (feat_drop): Dropout(p=0.0, inplace=False)
      (attn_drop): Dropout(p=0.0, inplace=False)
      (leaky_relu): LeakyReLU(negative_slope=0.2)
      (activation): Tanh()
    )
    (1): GATv2Conv(
      (fc_src): Linear(in_features=256, out_features=32, bias=True)
      (fc_dst): Linear(in_features=256, out_features=32, bias=True)
      (feat_drop): Dropout(p=0.0, inplace=False)
      (attn_drop): Dropout(p=0.0, inplace=False)
      (leaky_relu): LeakyReLU(negative_slope=0.2)
      (activation): Identity()
    )
  )
)
100%|██████████| 20/20 [05:32<00:00, 16.63s/it]
  0%|          | 0/20 [00:00<?, ?it/s]


 67%|██████▋   | 2/3 [00:13<00:06,  6.49s/it]
100%|██████████| 3/3 [00:17<00:00,  5.35s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 1
LOSS: train: 154.427261 grad: 13.364944  ham: 146.522034 |   test: 141.654343 grad: 10.279038 ham: 135.384781
  5%|▌         | 1/20 [00:18<05:52, 18.57s/it]


100%|██████████| 3/3 [00:16<00:00,  5.34s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 2
LOSS: train: 142.263351 grad: 12.990388  ham: 134.587051 |   test: 131.332031 grad: 10.265189 ham: 125.075462
 10%|█         | 2/20 [00:37<05:33, 18.53s/it]


 67%|██████▋   | 2/3 [00:13<00:06,  6.56s/it]
100%|██████████| 3/3 [00:17<00:00,  5.38s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 3
LOSS: train: 131.136948 grad: 13.053032  ham: 123.414833 |   test: 121.442497 grad: 10.201888 ham: 115.229172
 15%|█▌        | 3/20 [00:55<05:15, 18.58s/it]


 67%|██████▋   | 2/3 [00:12<00:06,  6.49s/it]
100%|██████████| 3/3 [00:16<00:00,  5.35s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 4
LOSS: train: 120.554955 grad: 13.100545  ham: 112.807037 |   test: 112.071808 grad: 10.218921 ham: 105.843567
 20%|██        | 4/20 [01:14<04:57, 18.58s/it]


 67%|██████▋   | 2/3 [00:13<00:06,  6.60s/it]
100%|██████████| 3/3 [00:17<00:00,  5.41s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 5
LOSS: train: 110.390320 grad: 12.686305  ham: 102.869812 |   test: 103.165436 grad: 10.197894 ham: 96.951523
 25%|██▌       | 5/20 [01:33<04:39, 18.64s/it]


 67%|██████▋   | 2/3 [00:12<00:06,  6.47s/it]
100%|██████████| 1/1 [00:01<00:00,  1.59s/it]
 30%|███       | 6/20 [01:51<04:20, 18.60s/it]
  0%|          | 0/3 [00:00<?, ?it/s]
Epoch: 6
LOSS: train: 101.027748 grad: 13.120366  ham: 93.259926 |   test: 94.719994 grad: 10.182565 ham: 88.514198


 67%|██████▋   | 2/3 [00:13<00:06,  6.50s/it]
100%|██████████| 3/3 [00:17<00:00,  5.42s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 7
LOSS: train: 92.098816 grad: 13.039565  ham: 84.393135 |   test: 86.613518 grad: 10.188855 ham: 80.405281
 35%|███▌      | 7/20 [02:10<04:02, 18.64s/it]


 67%|██████▋   | 2/3 [00:13<00:06,  6.50s/it]
100%|██████████| 3/3 [00:16<00:00,  5.35s/it]
  0%|          | 0/1 [00:00<?, ?it/s]
Epoch: 8
LOSS: train: 83.336540 grad: 13.003231  ham: 75.644188 |   test: 78.685562 grad: 10.211802 ham: 72.461426
 40%|████      | 8/20 [02:28<03:43, 18.62s/it]


 67%|██████▋   | 2/3 [00:13<00:06,  6.52s/it]
100%|██████████| 1/1 [00:01<00:00,  1.60s/it]
 45%|████▌     | 9/20 [02:47<03:24, 18.63s/it]
  0%|          | 0/3 [00:00<?, ?it/s]
Epoch: 9
LOSS: train: 74.859589 grad: 12.891884  ham: 67.235817 |   test: 70.695061 grad: 10.200767 ham: 64.480553
 33%|███▎      | 1/3 [00:06<00:13,  6.61s/it]
 67%|██████▋   | 2/3 [00:13<00:06,  6.52s/it]
 67%|██████▋   | 2/3 [00:13<00:06,  6.52s/it]
100%|██████████| 3/3 [00:17<00:00,  5.37s/it]
100%|██████████| 3/3 [00:17<00:00,  5.37s/it]
Epoch: 10
LOSS: train: 66.436256 grad: 12.812678  ham: 58.853222 |   test: 62.557564 grad: 10.276563 ham: 56.293194
  0%|          | 0/3 [00:00<?, ?it/s].59s/it]
 33%|███▎      | 1/3 [00:06<00:12,  6.49s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.49s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.49s/it]
100%|██████████| 3/3 [00:16<00:00,  5.36s/it]
100%|██████████| 3/3 [00:16<00:00,  5.36s/it]
Epoch: 11
LOSS: train: 57.461193 grad: 12.834335  ham: 49.854946 |   test: 54.000912 grad: 10.219112 ham: 47.776970
  0%|          | 0/3 [00:00<?, ?it/s].59s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.66s/it]
 67%|██████▋   | 2/3 [00:13<00:06,  6.54s/it]
 67%|██████▋   | 2/3 [00:13<00:06,  6.54s/it]
TEST
Epoch: 12
LOSS: train: 47.551746 grad: 13.053619  ham: 39.833294 |   test: 45.165596 grad: 10.345488 ham: 38.855614
  0%|          | 0/3 [00:00<?, ?it/s].58s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.51s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.49s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.49s/it]
100%|██████████| 3/3 [00:16<00:00,  5.36s/it]
100%|██████████| 3/3 [00:16<00:00,  5.36s/it]
Epoch: 13
LOSS: train: 37.769611 grad: 13.093387  ham: 30.033873 |   test: 35.971188 grad: 10.342978 ham: 29.662634
  0%|          | 0/3 [00:00<?, ?it/s].59s/it]
 33%|███▎      | 1/3 [00:06<00:12,  6.49s/it]
 67%|██████▋   | 2/3 [00:13<00:06,  6.59s/it]
 67%|██████▋   | 2/3 [00:13<00:06,  6.59s/it]
100%|██████████| 3/3 [00:17<00:00,  5.40s/it]
100%|██████████| 3/3 [00:17<00:00,  5.40s/it]
Epoch: 14
LOSS: train: 29.981928 grad: 13.028999  ham: 22.280792 |   test: 32.273788 grad: 10.309449 ham: 25.984547
  0%|          | 0/3 [00:00<?, ?it/s].60s/it]
 33%|███▎      | 1/3 [00:06<00:12,  6.49s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.49s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.49s/it]
TEST
Epoch: 15
LOSS: train: 29.504883 grad: 12.991246  ham: 21.819811 |   test: 32.108250 grad: 10.412775 ham: 25.752407
  0%|          | 0/3 [00:00<?, ?it/s].59s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.53s/it]
 67%|██████▋   | 2/3 [00:13<00:06,  6.52s/it]
 67%|██████▋   | 2/3 [00:13<00:06,  6.52s/it]
100%|██████████| 3/3 [00:17<00:00,  5.43s/it]
100%|██████████| 3/3 [00:17<00:00,  5.43s/it]
Epoch: 16
LOSS: train: 30.573465 grad: 13.191693  ham: 22.766138 |   test: 31.986073 grad: 10.439846 ham: 25.611582
  0%|          | 0/3 [00:00<?, ?it/s].59s/it]
 33%|███▎      | 1/3 [00:06<00:12,  6.50s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.50s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.50s/it]
100%|██████████| 3/3 [00:16<00:00,  5.35s/it]
100%|██████████| 3/3 [00:16<00:00,  5.35s/it]
Epoch: 17
LOSS: train: 30.951452 grad: 13.034410  ham: 23.230207 |   test: 31.373577 grad: 10.242564 ham: 25.127951
  0%|          | 0/3 [00:00<?, ?it/s].59s/it]
 33%|███▎      | 1/3 [00:06<00:12,  6.48s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.47s/it]
100%|██████████| 3/3 [00:16<00:00,  5.36s/it]
100%|██████████| 3/3 [00:16<00:00,  5.36s/it]
TEST
Epoch: 18
LOSS: train: 30.855452 grad: 13.300242  ham: 23.002756 |   test: 30.574875 grad: 10.272180 ham: 24.309454
  0%|          | 0/3 [00:00<?, ?it/s].59s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.61s/it]
 67%|██████▋   | 2/3 [00:13<00:06,  6.54s/it]
 67%|██████▋   | 2/3 [00:13<00:06,  6.54s/it]
100%|██████████| 3/3 [00:17<00:00,  5.37s/it]
100%|██████████| 3/3 [00:17<00:00,  5.37s/it]
Epoch: 19
LOSS: train: 29.260002 grad: 13.190666  ham: 21.460234 |   test: 29.681532 grad: 10.508262 ham: 23.266426
  0%|          | 0/3 [00:00<?, ?it/s].59s/it]
 33%|███▎      | 1/3 [00:06<00:12,  6.48s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.50s/it]
 67%|██████▋   | 2/3 [00:12<00:06,  6.50s/it]
100%|██████████| 3/3 [00:16<00:00,  5.36s/it]
100%|██████████| 3/3 [00:16<00:00,  5.36s/it]
Epoch: 20
LOSS: train: 27.389946 grad: 13.170902  ham: 19.613934 |   test: 28.584797 grad: 10.403110 ham: 22.234343
20
torch.Size([128, 1, 1, 17])
96 snapshots
torch.Size([32, 1, 17])
96
loading prevoius model
HNN_maker(
  (q_net): Sequential(
    (0): Linear(in_features=1, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=1, bias=True)
  )
  (net): Sequential(
    (0): GATv2Conv(
      (fc_src): Linear(in_features=2, out_features=256, bias=True)
      (fc_dst): Linear(in_features=2, out_features=256, bias=True)
      (feat_drop): Dropout(p=0.0, inplace=False)
      (attn_drop): Dropout(p=0.0, inplace=False)
      (leaky_relu): LeakyReLU(negative_slope=0.2)
      (activation): Tanh()
    )
    (1): GATv2Conv(
      (fc_src): Linear(in_features=256, out_features=32, bias=True)
      (fc_dst): Linear(in_features=256, out_features=32, bias=True)
      (feat_drop): Dropout(p=0.0, inplace=False)
      (attn_drop): Dropout(p=0.0, inplace=False)
      (leaky_relu): LeakyReLU(negative_slope=0.2)
      (activation): Identity()
    )
  )
)
  0%|          | 0/20 [00:00<?, ?it/s]60s/it]
  0%|          | 0/20 [00:00<?, ?it/s]60s/it]
  0%|          | 0/20 [00:00<?, ?it/s]60s/it]
  0%|          | 0/1 [00:00<?, ?it/s].61s/it]
  0%|          | 0/1 [00:00<?, ?it/s].61s/it]
TEST
Epoch: 1
LOSS: train: 44.017529 grad: 3.550877  ham: 40.376743 |   test: 57.060543 grad: 3.621212 ham: 53.450428
  5%|▌         | 1/20 [00:18<05:49, 18.40s/it]
  5%|▌         | 1/20 [00:18<05:49, 18.40s/it]
  5%|▌         | 1/20 [00:18<05:49, 18.40s/it]
  5%|▌         | 1/20 [00:18<05:49, 18.40s/it]
  0%|          | 0/1 [00:00<?, ?it/s].63s/it]]
  0%|          | 0/1 [00:00<?, ?it/s].63s/it]]
Epoch: 2
LOSS: train: 40.843563 grad: 3.564110  ham: 37.199078 |   test: 55.999451 grad: 3.598164 ham: 52.405434
 10%|█         | 2/20 [00:36<05:31, 18.44s/it]
 10%|█         | 2/20 [00:36<05:31, 18.44s/it]
 10%|█         | 2/20 [00:36<05:31, 18.44s/it]
 10%|█         | 2/20 [00:36<05:31, 18.44s/it]
  0%|          | 0/1 [00:00<?, ?it/s].72s/it]]
  0%|          | 0/1 [00:00<?, ?it/s].72s/it]]
Epoch: 3
LOSS: train: 37.086620 grad: 3.514985  ham: 33.469040 |   test: 49.843990 grad: 3.589443 ham: 46.270782
 15%|█▌        | 3/20 [00:55<05:15, 18.58s/it]
 15%|█▌        | 3/20 [00:55<05:15, 18.58s/it]
 15%|█▌        | 3/20 [00:55<05:15, 18.58s/it]
 15%|█▌        | 3/20 [00:55<05:15, 18.58s/it]
TEST
Epoch: 4
LOSS: train: 32.467651 grad: 3.584490  ham: 28.824350 |   test: 55.927738 grad: 3.600088 ham: 52.333244
 20%|██        | 4/20 [01:14<04:57, 18.61s/it]
 20%|██        | 4/20 [01:14<04:57, 18.61s/it]
 20%|██        | 4/20 [01:14<04:57, 18.61s/it]
 20%|██        | 4/20 [01:14<04:57, 18.61s/it]
  0%|          | 0/1 [00:00<?, ?it/s].74s/it]]
  0%|          | 0/1 [00:00<?, ?it/s].74s/it]]
Epoch: 5
LOSS: train: 41.305737 grad: 3.529070  ham: 37.661587 |   test: 55.836338 grad: 3.612333 ham: 52.251030
 25%|██▌       | 5/20 [01:33<04:40, 18.69s/it]
 25%|██▌       | 5/20 [01:33<04:40, 18.69s/it]
 25%|██▌       | 5/20 [01:33<04:40, 18.69s/it]
 25%|██▌       | 5/20 [01:33<04:40, 18.69s/it]
  0%|          | 0/1 [00:00<?, ?it/s].69s/it]]
  0%|          | 0/1 [00:00<?, ?it/s].69s/it]]
Epoch: 6
LOSS: train: 46.262524 grad: 3.506118  ham: 42.638195 |   test: 47.936176 grad: 3.588044 ham: 44.363083
 30%|███       | 6/20 [01:51<04:21, 18.68s/it]
 30%|███       | 6/20 [01:51<04:21, 18.68s/it]
 30%|███       | 6/20 [01:51<04:21, 18.68s/it]
 30%|███       | 6/20 [01:51<04:21, 18.68s/it]
  0%|          | 0/3 [00:00<?, ?it/s].60s/it]]
  0%|          | 0/3 [00:00<?, ?it/s].60s/it]]
Epoch: 7
LOSS: train: 51.282215 grad: 3.501328  ham: 47.665165 |   test: 47.514130 grad: 3.653535 ham: 43.906681
 33%|███▎      | 1/3 [00:06<00:13,  6.52s/it]]
 67%|██████▋   | 2/3 [00:13<00:06,  6.53s/it]]
 67%|██████▋   | 2/3 [00:13<00:06,  6.53s/it]]
100%|██████████| 3/3 [00:17<00:00,  5.38s/it]]
100%|██████████| 3/3 [00:17<00:00,  5.38s/it]]
Epoch: 8
LOSS: train: 41.259689 grad: 3.523423  ham: 37.610596 |   test: 46.593887 grad: 3.634850 ham: 42.975197
 40%|████      | 8/20 [02:29<03:44, 18.72s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.59s/it]]
 67%|██████▋   | 2/3 [00:13<00:06,  6.55s/it]]
 67%|██████▋   | 2/3 [00:13<00:06,  6.55s/it]]
100%|██████████| 3/3 [00:17<00:00,  5.40s/it]]
100%|██████████| 3/3 [00:17<00:00,  5.40s/it]]
Epoch: 9
LOSS: train: 39.558899 grad: 3.515800  ham: 35.893406 |   test: 41.252247 grad: 3.642131 ham: 37.629086
 45%|████▌     | 9/20 [02:48<03:25, 18.72s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.64s/it]]
 67%|██████▋   | 2/3 [00:13<00:06,  6.57s/it]]
 67%|██████▋   | 2/3 [00:13<00:06,  6.57s/it]]
  0%|          | 0/3 [00:00<?, ?it/s].59s/it]]
  0%|          | 0/3 [00:00<?, ?it/s].59s/it]]
Epoch: 10
LOSS: train: 35.570805 grad: 3.573391  ham: 31.901779 |   test: 33.920116 grad: 3.659225 ham: 30.293018
 33%|███▎      | 1/3 [00:06<00:13,  6.52s/it]]
 67%|██████▋   | 2/3 [00:13<00:06,  6.53s/it]]
 67%|██████▋   | 2/3 [00:13<00:06,  6.53s/it]]
100%|██████████| 3/3 [00:17<00:00,  5.38s/it]]
100%|██████████| 3/3 [00:17<00:00,  5.38s/it]]
Epoch: 11
LOSS: train: 38.424591 grad: 3.542647  ham: 34.793198 |   test: 50.046806 grad: 3.749791 ham: 46.381168
 55%|█████▌    | 11/20 [03:25<02:48, 18.73s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.54s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.61s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.43s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.43s/it]t]
TEST
Epoch: 12
LOSS: train: 37.384220 grad: 3.574802  ham: 33.691330 |   test: 29.600170 grad: 3.626630 ham: 26.003607
 60%|██████    | 12/20 [03:44<02:30, 18.75s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.54s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.52s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.52s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.37s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.37s/it]t]
Epoch: 13
LOSS: train: 37.666336 grad: 3.455259  ham: 34.095535 |   test: 30.166924 grad: 3.667449 ham: 26.532019
 65%|██████▌   | 13/20 [04:02<02:11, 18.72s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.56s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.54s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.54s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.46s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.46s/it]t]
Epoch: 14
LOSS: train: 44.012569 grad: 3.513505  ham: 40.379391 |   test: 34.023720 grad: 3.643302 ham: 30.416592
 70%|███████   | 14/20 [04:21<01:52, 18.76s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.51s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.53s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.39s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.39s/it]t]
TEST
Epoch: 15
LOSS: train: 45.575943 grad: 3.612302  ham: 41.887608 |   test: 53.244095 grad: 3.680407 ham: 49.604698
 75%|███████▌  | 15/20 [04:40<01:33, 18.73s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.54s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.53s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.53s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.38s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.38s/it]t]
Epoch: 16
LOSS: train: 40.241756 grad: 3.557630  ham: 36.572994 |   test: 29.208984 grad: 3.616558 ham: 25.617279
 80%|████████  | 16/20 [04:59<01:14, 18.71s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.65s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.58s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.58s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.40s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.40s/it]t]
Epoch: 17
LOSS: train: 32.445019 grad: 3.541527  ham: 28.793610 |   test: 33.789257 grad: 3.663964 ham: 30.158142
 85%|████████▌ | 17/20 [05:17<00:56, 18.74s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.53s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.53s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.53s/it]t]
TEST
Epoch: 18
LOSS: train: 37.459827 grad: 3.546361  ham: 33.789196 |   test: 52.046257 grad: 3.779890 ham: 48.348129
  0%|          | 0/3 [00:00<?, ?it/s].60s/it]t]
 33%|███▎      | 1/3 [00:06<00:13,  6.54s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.58s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.58s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.41s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.41s/it]t]
Epoch: 19
LOSS: train: 37.872494 grad: 3.508843  ham: 34.224777 |   test: 30.864309 grad: 3.557941 ham: 27.294872
 95%|█████████▌| 19/20 [05:55<00:18, 18.73s/it]
 33%|███▎      | 1/3 [00:06<00:13,  6.53s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.51s/it]t]
 67%|██████▋   | 2/3 [00:13<00:06,  6.51s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.37s/it]t]
100%|██████████| 3/3 [00:17<00:00,  5.37s/it]t]
Epoch: 20
100%|██████████| 20/20 [06:14<00:00, 18.70s/it]
100%|██████████| 20/20 [06:14<00:00, 18.70s/it]