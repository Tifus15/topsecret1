Config file content:
{'model': 'GAT', 'sob': [True, True], 'sob_a': [0.15, 1.0], 'a': 0.01, 'opti': 'adamW', 'reg': 'none', 'loss': 'Huber', 'acts': ['tanh', None], 'epochs': 50, 'modelsize': 256, 'batchsize': 128, 'timesize': 32, 'lr': 0.001, 'split': 0.9, 'device': 'cpu', 'single': False, 'noloops': True, 'samples': 15}
50
GNN_maker_HNN(
  (net): Sequential(
    (0): GATLayer(
      (fc): Linear(in_features=2, out_features=128, bias=False)
      (attn_fc): Linear(in_features=256, out_features=1, bias=False)
    )
    (1): Tanh()
    (2): GATLayer(
      (fc): Linear(in_features=128, out_features=6, bias=False)
      (attn_fc): Linear(in_features=12, out_features=1, bias=False)
    )
  )
)
torch.Size([128, 15, 1, 5])
15
torch.Size([32, 1, 4])
GNN_maker_HNN(
  (net): Sequential(
    (0): GATLayer(
      (fc): Linear(in_features=2, out_features=128, bias=False)
      (attn_fc): Linear(in_features=256, out_features=1, bias=False)
    )
    (1): Tanh()
    (2): GATLayer(
      (fc): Linear(in_features=128, out_features=6, bias=False)
      (attn_fc): Linear(in_features=12, out_features=1, bias=False)
    )
  )
)
TRAIN BATCHES : 10
TEST BATCHES : 1
TRAIN
  0%|                                                                                                                                                   | 0/50 [00:00<?, ?it/s]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.86s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  2%|██▊                                                                                                                                        | 1/50 [00:53<43:20, 53.07s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 1
LOSS: train: 9.916419   ham: 9.811789 |   test: 2.194972  ham: 9.982383
{'net.0.fc.weight_grad': 0.0009208903647959232, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.00014607305638492107, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:43<00:04,  4.88s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.84s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
Epoch: 2
LOSS: train: 9.086971   ham: 8.982586 |   test: 2.062337  ham: 9.060389
{'net.0.fc.weight_grad': 0.001025970559567213, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.002335550496354699, 'net.2.attn_fc.weight_grad': 0.0}
  4%|█████▌                                                                                                                                     | 2/50 [01:46<42:29, 53.12s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.87s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  6%|████████▎                                                                                                                                  | 3/50 [02:39<41:33, 53.06s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 3
LOSS: train: 8.764564   ham: 8.657346 |   test: 2.077097  ham: 8.908976
{'net.0.fc.weight_grad': 0.0011985385790467262, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.00738309184089303, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.81s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 4
LOSS: train: 8.620934   ham: 8.512243 |   test: 2.009522  ham: 8.467851
{'net.0.fc.weight_grad': 0.0034439421724528074, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0029531270265579224, 'net.2.attn_fc.weight_grad': 0.0}
  8%|███████████                                                                                                                                | 4/50 [03:32<40:39, 53.04s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.89s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 10%|█████████████▉                                                                                                                             | 5/50 [04:25<39:54, 53.22s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 5
LOSS: train: 8.522988   ham: 8.413794 |   test: 2.012360  ham: 8.461684
{'net.0.fc.weight_grad': 0.0020914943888783455, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.00036813001497648656, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.90s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 12%|████████████████▋                                                                                                                          | 6/50 [05:19<39:09, 53.40s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 6
LOSS: train: 8.456388   ham: 8.346025 |   test: 2.032041  ham: 8.288017
{'net.0.fc.weight_grad': 0.0032064062543213367, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.00048440578393638134, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:43<00:04,  4.85s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.86s/it]
 14%|███████████████████▍                                                                                                                       | 7/50 [06:12<38:11, 53.30s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 7
LOSS: train: 8.421910   ham: 8.308775 |   test: 1.974584  ham: 7.978589
{'net.0.fc.weight_grad': 0.0009290688904002309, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.00034748390316963196, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.82s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 16%|██████████████████████▏                                                                                                                    | 8/50 [07:05<37:14, 53.20s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 8
LOSS: train: 8.350696   ham: 8.235698 |   test: 1.953756  ham: 7.728501
{'net.0.fc.weight_grad': 0.0035610049962997437, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0025773877277970314, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.82s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 9
LOSS: train: 8.344156   ham: 8.228030 |   test: 2.063072  ham: 8.205042
{'net.0.fc.weight_grad': 0.0035475101321935654, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0021000902634114027, 'net.2.attn_fc.weight_grad': 0.0}
 18%|█████████████████████████                                                                                                                  | 9/50 [07:58<36:13, 53.01s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:47<00:00,  4.78s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 10
LOSS: train: 8.325614   ham: 8.208854 |   test: 1.992807  ham: 7.973793
{'net.0.fc.weight_grad': 0.0037554793525487185, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0011541886487975717, 'net.2.attn_fc.weight_grad': 0.0}
 20%|███████████████████████████▌                                                                                                              | 10/50 [08:50<35:13, 52.84s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.88s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 22%|██████████████████████████████▎                                                                                                           | 11/50 [09:43<34:26, 52.98s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 11
LOSS: train: 8.318279   ham: 8.200150 |   test: 2.073502  ham: 8.373043
{'net.0.fc.weight_grad': 0.0028946762904524803, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0023399684578180313, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:43<00:04,  4.87s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.86s/it]
 24%|█████████████████████████████████                                                                                                         | 12/50 [10:37<33:38, 53.13s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 12
LOSS: train: 8.307795   ham: 8.188475 |   test: 1.936175  ham: 7.560638
{'net.0.fc.weight_grad': 0.0028788354247808456, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.00022146072296891361, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:44<00:04,  4.91s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.92s/it]
 26%|███████████████████████████████████▉                                                                                                      | 13/50 [11:31<32:52, 53.32s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 13
LOSS: train: 8.303853   ham: 8.185015 |   test: 1.958675  ham: 7.703867
{'net.0.fc.weight_grad': 0.0021527870558202267, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.002108849585056305, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.84s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 28%|██████████████████████████████████████▋                                                                                                   | 14/50 [12:24<31:57, 53.26s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 14
LOSS: train: 8.278906   ham: 8.159813 |   test: 1.978685  ham: 7.703332
{'net.0.fc.weight_grad': 0.006545168347656727, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0023893893230706453, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:43<00:04,  4.89s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.83s/it]
 30%|█████████████████████████████████████████▍                                                                                                | 15/50 [13:17<31:04, 53.27s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 15
LOSS: train: 8.273074   ham: 8.153646 |   test: 2.016026  ham: 7.968328
{'net.0.fc.weight_grad': 0.0025310120545327663, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -3.536055373842828e-05, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.82s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 16
LOSS: train: 8.267078   ham: 8.147976 |   test: 1.942644  ham: 7.650613
{'net.0.fc.weight_grad': 0.0001203656429424882, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0018585039069876075, 'net.2.attn_fc.weight_grad': 0.0}
 32%|████████████████████████████████████████████▏                                                                                             | 16/50 [14:10<30:09, 53.22s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.90s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 34%|██████████████████████████████████████████████▉                                                                                           | 17/50 [15:04<29:18, 53.28s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 17
LOSS: train: 8.263414   ham: 8.144121 |   test: 2.010211  ham: 7.838840
{'net.0.fc.weight_grad': 0.0029929340817034245, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0005383357056416571, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.84s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 18
LOSS: train: 8.242385   ham: 8.123305 |   test: 2.023016  ham: 7.978992
{'net.0.fc.weight_grad': 0.001996189123019576, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0006910514202900231, 'net.2.attn_fc.weight_grad': 0.0}
 36%|█████████████████████████████████████████████████▋                                                                                        | 18/50 [15:57<28:21, 53.16s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.91s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 19
LOSS: train: 8.226072   ham: 8.107359 |   test: 1.981839  ham: 7.793050
{'net.0.fc.weight_grad': 0.0034465701319277287, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0023114748764783144, 'net.2.attn_fc.weight_grad': 0.0}
 38%|████████████████████████████████████████████████████▍                                                                                     | 19/50 [16:50<27:35, 53.41s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.87s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 40%|███████████████████████████████████████████████████████▏                                                                                  | 20/50 [17:44<26:44, 53.48s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 20
LOSS: train: 8.216249   ham: 8.097856 |   test: 1.927962  ham: 7.480141
{'net.0.fc.weight_grad': -0.0005956944078207016, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.002243817551061511, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.90s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 42%|█████████████████████████████████████████████████████████▉                                                                                | 21/50 [18:38<25:50, 53.47s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 21
LOSS: train: 8.215481   ham: 8.096945 |   test: 2.016693  ham: 7.902747
{'net.0.fc.weight_grad': 0.0011797251645475626, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0009247412090189755, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.86s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 22
LOSS: train: 8.210502   ham: 8.091387 |   test: 1.875257  ham: 7.253474
{'net.0.fc.weight_grad': -0.001120984903536737, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0005485835135914385, 'net.2.attn_fc.weight_grad': 0.0}
 44%|████████████████████████████████████████████████████████████▋                                                                             | 22/50 [19:31<24:55, 53.39s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.83s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 46%|███████████████████████████████████████████████████████████████▍                                                                          | 23/50 [20:24<23:59, 53.32s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 23
LOSS: train: 8.199659   ham: 8.080469 |   test: 2.007145  ham: 7.916498
{'net.0.fc.weight_grad': 0.00021647938410751522, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.00024526380002498627, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:44<00:04,  4.93s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.94s/it]
 48%|██████████████████████████████████████████████████████████████████▏                                                                       | 24/50 [21:18<23:09, 53.44s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 24
LOSS: train: 8.184634   ham: 8.066646 |   test: 1.825508  ham: 7.127238
{'net.0.fc.weight_grad': 0.0030670356936752796, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -6.427755579352379e-06, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.87s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 50%|█████████████████████████████████████████████████████████████████████                                                                     | 25/50 [22:11<22:18, 53.52s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 25
LOSS: train: 8.163572   ham: 8.045212 |   test: 1.974297  ham: 7.694356
{'net.0.fc.weight_grad': 0.00013397738803178072, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0010376436403021216, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.93s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 52%|███████████████████████████████████████████████████████████████████████▊                                                                  | 26/50 [23:06<21:29, 53.71s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 26
LOSS: train: 8.166643   ham: 8.047622 |   test: 1.879177  ham: 7.241723
{'net.0.fc.weight_grad': -0.0005831876187585294, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0008829762227833271, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.92s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 27
LOSS: train: 8.150367   ham: 8.031962 |   test: 1.954606  ham: 7.645880
{'net.0.fc.weight_grad': -0.003966985736042261, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.004015458282083273, 'net.2.attn_fc.weight_grad': 0.0}
 54%|██████████████████████████████████████████████████████████████████████████▌                                                               | 27/50 [23:59<20:34, 53.66s/it]




 54%|██████████████████████████████████████████████████████████████████████████▌                                                               | 27/50 [24:27<20:49, 54.34s/it]
Traceback (most recent call last):
  File "/home/denis/Desktop/server-graph-models/new_HGNN/main_pend.py", line 991, in <module>
    train1dof(configs)
  File "/home/denis/Desktop/server-graph-models/new_HGNN/main_pend.py", line 208, in train1dof
    x_pred = RKroll_for_learning(model,x0,ts)
  File "/home/denis/Desktop/server-graph-models/new_HGNN/utils.py", line 160, in RKroll_for_learning
    K2 = evaluate_model(model,out_l[i-1].squeeze()+dt*K1/2)
  File "/home/denis/Desktop/server-graph-models/new_HGNN/utils.py", line 148, in evaluate_model
    h_pred = model(x)
  File "/home/denis/anaconda3/envs/dgl_hnn/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/denis/anaconda3/envs/dgl_hnn/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/denis/Desktop/server-graph-models/new_HGNN/HGNN.py", line 160, in forward
    gs = dgl.unbatch(self.g_hnn)
  File "/home/denis/anaconda3/envs/dgl_hnn/lib/python3.9/site-packages/dgl/batch.py", line 424, in unbatch
    gs = [
  File "/home/denis/anaconda3/envs/dgl_hnn/lib/python3.9/site-packages/dgl/batch.py", line 425, in <listcomp>
    convert.heterograph(edge_dict, num_nodes_dict, idtype=g.idtype)
  File "/home/denis/anaconda3/envs/dgl_hnn/lib/python3.9/site-packages/dgl/convert.py", line 332, in heterograph
    (sparse_fmt, arrays), urange, vrange = utils.graphdata2tensors(
  File "/home/denis/anaconda3/envs/dgl_hnn/lib/python3.9/site-packages/dgl/utils/data.py", line 165, in graphdata2tensors
    if not isinstance(data[0], str):
KeyboardInterrupt