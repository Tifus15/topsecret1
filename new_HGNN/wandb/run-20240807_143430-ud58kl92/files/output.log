Config file content:
{'model': 'GAT', 'sob': [True, True], 'sob_a': [1.0, 0.15], 'a': 0.01, 'opti': 'adamW', 'reg': 'none', 'loss': 'Huber', 'acts': ['tanh', None], 'epochs': 25, 'modelsize': 256, 'batchsize': 128, 'timesize': 32, 'lr': 0.001, 'split': 0.9, 'device': 'cpu', 'single': False, 'noloops': True, 'samples': 15}
25
GNN_maker_HNN(
  (net): Sequential(
    (0): GATLayer(
      (fc): Linear(in_features=2, out_features=128, bias=False)
      (attn_fc): Linear(in_features=256, out_features=1, bias=False)
    )
    (1): Tanh()
    (2): GATLayer(
      (fc): Linear(in_features=128, out_features=6, bias=False)
      (attn_fc): Linear(in_features=12, out_features=1, bias=False)
    )
  )
)
torch.Size([128, 15, 1, 5])
15
torch.Size([32, 1, 4])
GNN_maker_HNN(
  (net): Sequential(
    (0): GATLayer(
      (fc): Linear(in_features=2, out_features=128, bias=False)
      (attn_fc): Linear(in_features=256, out_features=1, bias=False)
    )
    (1): Tanh()
    (2): GATLayer(
      (fc): Linear(in_features=128, out_features=6, bias=False)
      (attn_fc): Linear(in_features=12, out_features=1, bias=False)
    )
  )
)
TRAIN BATCHES : 10
TEST BATCHES : 1
TRAIN
  0%|                                                                                                                                                   | 0/25 [00:00<?, ?it/s]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:51<00:00,  5.18s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  4%|█████▌                                                                                                                                     | 1/25 [00:56<22:40, 56.70s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 1
LOSS: train: 2.115555   ham: 9.443010 |   test: 2.028650  ham: 9.439613
{'net.0.fc.weight_grad': -0.00045992061495780945, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0020174020901322365, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.79s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  8%|███████████                                                                                                                                | 2/25 [01:49<20:50, 54.39s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 2
LOSS: train: 2.022670   ham: 8.772099 |   test: 1.951593  ham: 8.782013
{'net.0.fc.weight_grad': -0.00042661966290324926, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0005487085436470807, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.99s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 3
LOSS: train: 1.999745   ham: 8.521583 |   test: 1.999716  ham: 8.984669
{'net.0.fc.weight_grad': 0.0003706069546751678, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0023746953811496496, 'net.2.attn_fc.weight_grad': 0.0}
 12%|████████████████▋                                                                                                                          | 3/25 [02:44<19:58, 54.48s/it]









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.14s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:51<00:00,  5.20s/it]
 16%|██████████████████████▏                                                                                                                    | 4/25 [03:41<19:24, 55.46s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 4
LOSS: train: 1.989416   ham: 8.433563 |   test: 1.905078  ham: 8.591869
{'net.0.fc.weight_grad': -0.0002191788807976991, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -3.239081706851721e-06, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:45<00:05,  5.07s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:50<00:00,  5.09s/it]
 20%|███████████████████████████▊                                                                                                               | 5/25 [04:37<18:34, 55.72s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 5
LOSS: train: 1.986556   ham: 8.402173 |   test: 1.926450  ham: 8.589764
{'net.0.fc.weight_grad': -0.0006365969311445951, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0003939844900742173, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:51<00:00,  5.27s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 24%|█████████████████████████████████▎                                                                                                         | 6/25 [05:33<17:44, 56.03s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 6
LOSS: train: 1.981060   ham: 8.350725 |   test: 1.962995  ham: 8.880108
{'net.0.fc.weight_grad': 0.00040690062451176345, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0034631825983524323, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:45<00:05,  5.14s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:50<00:00,  5.10s/it]
 28%|██████████████████████████████████████▉                                                                                                    | 7/25 [06:29<16:44, 55.80s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 7
LOSS: train: 1.979055   ham: 8.339513 |   test: 1.918817  ham: 8.587824
{'net.0.fc.weight_grad': -0.0005360219511203468, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0007039117626845837, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:51<00:00,  5.13s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 32%|████████████████████████████████████████████▍                                                                                              | 8/25 [07:25<15:51, 55.99s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 8
LOSS: train: 1.976170   ham: 8.334472 |   test: 1.881754  ham: 8.442533
{'net.0.fc.weight_grad': -0.0004001755150966346, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.001272833440452814, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.12s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:50<00:00,  5.03s/it]
 36%|██████████████████████████████████████████████████                                                                                         | 9/25 [08:21<14:54, 55.91s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 9
LOSS: train: 1.968468   ham: 8.297535 |   test: 1.937009  ham: 8.656448
{'net.0.fc.weight_grad': -0.000599672261159867, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.001359661458991468, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:45<00:05,  5.20s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:50<00:00,  5.25s/it]
 40%|███████████████████████████████████████████████████████▏                                                                                  | 10/25 [09:17<13:59, 55.97s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 10
LOSS: train: 1.965739   ham: 8.299103 |   test: 1.940054  ham: 8.721295
{'net.0.fc.weight_grad': -0.0001580830430611968, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0001702250010566786, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:47<00:05,  5.35s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:53<00:00,  5.43s/it]
 44%|████████████████████████████████████████████████████████████▋                                                                             | 11/25 [10:15<13:13, 56.65s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 11
LOSS: train: 1.962082   ham: 8.291005 |   test: 1.845941  ham: 8.182699
{'net.0.fc.weight_grad': -0.0005740714259445667, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0006812390056438744, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.85s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 48%|██████████████████████████████████████████████████████████████████▏                                                                       | 12/25 [11:09<12:07, 55.93s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 12
LOSS: train: 1.958988   ham: 8.274936 |   test: 1.870696  ham: 8.382066
{'net.0.fc.weight_grad': -0.0008105732267722487, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 7.073226879583672e-05, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.80s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 13
LOSS: train: 1.952430   ham: 8.245208 |   test: 1.829732  ham: 8.058584
{'net.0.fc.weight_grad': -0.0009979045717045665, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -3.8742397009627894e-05, 'net.2.attn_fc.weight_grad': 0.0}
 52%|███████████████████████████████████████████████████████████████████████▊                                                                  | 13/25 [12:02<10:59, 54.95s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:47<00:00,  4.80s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 14
LOSS: train: 1.946891   ham: 8.204557 |   test: 1.926671  ham: 8.545992
{'net.0.fc.weight_grad': -0.000629326154012233, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0008209953084588051, 'net.2.attn_fc.weight_grad': 0.0}
 56%|█████████████████████████████████████████████████████████████████████████████▎                                                            | 14/25 [12:54<09:55, 54.17s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:47<00:00,  4.69s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 15
LOSS: train: 1.945494   ham: 8.221529 |   test: 1.920592  ham: 8.630298
{'net.0.fc.weight_grad': -0.0008772434666752815, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.00030445880838669837, 'net.2.attn_fc.weight_grad': 0.0}
 60%|██████████████████████████████████████████████████████████████████████████████████▊                                                       | 15/25 [13:46<08:54, 53.45s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:47<00:00,  4.73s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 16/25 [14:38<07:56, 52.95s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 16
LOSS: train: 1.938390   ham: 8.192616 |   test: 1.858909  ham: 8.311938
{'net.0.fc.weight_grad': -0.0013611913891509175, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.00357944262214005, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:47<00:00,  4.82s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 17
LOSS: train: 1.932459   ham: 8.149141 |   test: 1.911048  ham: 8.489827
{'net.0.fc.weight_grad': -0.000970575085375458, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.00027886658790521324, 'net.2.attn_fc.weight_grad': 0.0}
 68%|█████████████████████████████████████████████████████████████████████████████████████████████▊                                            | 17/25 [15:30<07:02, 52.79s/it]









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:43<00:04,  4.82s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.79s/it]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 18/25 [16:23<06:09, 52.78s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 18
LOSS: train: 1.930725   ham: 8.147653 |   test: 1.880678  ham: 8.407575
{'net.0.fc.weight_grad': -0.0004287123738322407, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.00047906956751830876, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.82s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 76%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 19/25 [17:16<05:16, 52.82s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 19
LOSS: train: 1.923779   ham: 8.139820 |   test: 1.947495  ham: 8.718662
{'net.0.fc.weight_grad': -0.0005362840602174401, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0005612612585537136, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:47<00:00,  4.74s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                           | 20/25 [18:08<04:22, 52.59s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 20
LOSS: train: 1.920261   ham: 8.112358 |   test: 1.888829  ham: 8.376379
{'net.0.fc.weight_grad': -0.00026441048248670995, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0017767088720574975, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:47<00:00,  4.81s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 21
LOSS: train: 1.910923   ham: 8.057230 |   test: 1.861233  ham: 8.337545
{'net.0.fc.weight_grad': -0.00037962966598570347, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0008652480901218951, 'net.2.attn_fc.weight_grad': 0.0}
 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 21/25 [19:01<03:30, 52.61s/it]









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:43<00:04,  4.79s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.80s/it]
 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 22/25 [19:53<02:37, 52.60s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 22
LOSS: train: 1.911124   ham: 8.051428 |   test: 1.821509  ham: 8.063993
{'net.0.fc.weight_grad': -0.001090884325094521, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.00028651594766415656, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:47<00:00,  4.82s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 23/25 [20:46<01:45, 52.54s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 23
LOSS: train: 1.901524   ham: 8.008390 |   test: 1.868366  ham: 8.353082
{'net.0.fc.weight_grad': -0.0009178348118439317, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0008092687930911779, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.82s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍     | 24/25 [21:39<00:52, 52.61s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 24
LOSS: train: 1.897189   ham: 7.989082 |   test: 1.811381  ham: 7.989590
{'net.0.fc.weight_grad': -0.000330928189214319, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.00041908430284820497, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:47<00:00,  4.75s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 25
LOSS: train: 1.892087   ham: 7.967298 |   test: 1.855452  ham: 8.187346
{'net.0.fc.weight_grad': -0.00036479352274909616, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0016062435461208224, 'net.2.attn_fc.weight_grad': 0.0}
25
torch.Size([128, 15, 1, 9])
15
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [22:31<00:00, 54.05s/it]
  0%|                                                                                                                                                   | 0/25 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
loading prevoius model
GNN_maker_HNN(
  (net): Sequential(
    (0): GATLayer(
      (fc): Linear(in_features=2, out_features=128, bias=False)
      (attn_fc): Linear(in_features=256, out_features=1, bias=False)
    )
    (1): Tanh()
    (2): GATLayer(
      (fc): Linear(in_features=128, out_features=6, bias=False)
      (attn_fc): Linear(in_features=12, out_features=1, bias=False)
    )
  )
)
TRAIN BATCHES : 10
TEST BATCHES : 1









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.93s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  4%|█████▌                                                                                                                                     | 1/25 [00:54<21:40, 54.17s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 1
LOSS: train: 5.522964   ham: 29.419827 |   test: 4.695958  ham: 23.104012
{'net.0.fc.weight_grad': -0.0015070599038153887, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.011455491185188293, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.97s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  8%|███████████                                                                                                                                | 2/25 [01:48<20:47, 54.24s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 2
LOSS: train: 4.404459   ham: 21.806721 |   test: 3.612501  ham: 15.998224
{'net.0.fc.weight_grad': 0.003020813222974539, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.01659771241247654, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.93s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 12%|████████████████▋                                                                                                                          | 3/25 [02:42<19:50, 54.11s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 3
LOSS: train: 5.054744   ham: 26.087246 |   test: 4.831573  ham: 23.894356
{'net.0.fc.weight_grad': 0.0003275535418651998, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.0040364512242376804, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.95s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 16%|██████████████████████▏                                                                                                                    | 4/25 [03:36<18:53, 54.00s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 4
LOSS: train: 5.180146   ham: 26.897720 |   test: 4.637987  ham: 22.849770
{'net.0.fc.weight_grad': -0.0012795217335224152, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.009351328015327454, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.94s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 20%|███████████████████████████▊                                                                                                               | 5/25 [04:30<18:01, 54.08s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 5
LOSS: train: 4.740064   ham: 23.989779 |   test: 4.806304  ham: 23.793278
{'net.0.fc.weight_grad': -0.0006535756401717663, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.004958528093993664, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  5.03s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 6
LOSS: train: 4.837405   ham: 24.675594 |   test: 3.512810  ham: 15.119800
{'net.0.fc.weight_grad': -0.002462211064994335, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.013028386980295181, 'net.2.attn_fc.weight_grad': 0.0}
 24%|█████████████████████████████████▎                                                                                                         | 6/25 [05:24<17:09, 54.18s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.99s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 7
LOSS: train: 5.808249   ham: 31.089956 |   test: 6.743474  ham: 36.668549
{'net.0.fc.weight_grad': 0.0011838632635772228, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.002213146537542343, 'net.2.attn_fc.weight_grad': 0.0}
 28%|██████████████████████████████████████▉                                                                                                    | 7/25 [06:19<16:16, 54.26s/it]









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:44<00:05,  5.04s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  5.02s/it]
 32%|████████████████████████████████████████████▍                                                                                              | 8/25 [07:14<15:25, 54.43s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 8
LOSS: train: 4.846885   ham: 24.544607 |   test: 3.948359  ham: 17.859678
{'net.0.fc.weight_grad': 0.0034488257952034473, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.016316009685397148, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:44<00:04,  4.95s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.90s/it]
 36%|██████████████████████████████████████████████████                                                                                         | 9/25 [08:08<14:29, 54.34s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 9
LOSS: train: 4.672336   ham: 23.394781 |   test: 5.928864  ham: 31.069906
{'net.0.fc.weight_grad': -0.0015234671300277114, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.009592411108314991, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.82s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 40%|███████████████████████████████████████████████████████▏                                                                                  | 10/25 [09:01<13:31, 54.13s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 10
LOSS: train: 4.817105   ham: 24.516788 |   test: 5.447706  ham: 28.120640
{'net.0.fc.weight_grad': -0.000964987266343087, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.005310388281941414, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.91s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 44%|████████████████████████████████████████████████████████████▋                                                                             | 11/25 [09:55<12:36, 54.00s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 11
LOSS: train: 5.128156   ham: 26.624226 |   test: 3.459692  ham: 14.793550
{'net.0.fc.weight_grad': -0.001390766235999763, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.006818824913352728, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.86s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 12
LOSS: train: 5.055867   ham: 26.090998 |   test: 4.488741  ham: 21.773613
{'net.0.fc.weight_grad': 0.0017445569392293692, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.010258344002068043, 'net.2.attn_fc.weight_grad': 0.0}
 48%|██████████████████████████████████████████████████████████████████▏                                                                       | 12/25 [10:49<11:41, 53.98s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.95s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 52%|███████████████████████████████████████████████████████████████████████▊                                                                  | 13/25 [11:43<10:49, 54.10s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 13
LOSS: train: 4.473576   ham: 22.149607 |   test: 4.773349  ham: 23.439489
{'net.0.fc.weight_grad': 0.003072502790018916, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.018587253987789154, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.92s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 56%|█████████████████████████████████████████████████████████████████████████████▎                                                            | 14/25 [12:38<09:55, 54.13s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 14
LOSS: train: 4.666404   ham: 23.491072 |   test: 4.734529  ham: 23.518375
{'net.0.fc.weight_grad': 0.003307799343019724, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.01890653930604458, 'net.2.attn_fc.weight_grad': 0.0}









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:44<00:04,  4.96s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.94s/it]
 60%|██████████████████████████████████████████████████████████████████████████████████▊                                                       | 15/25 [13:32<09:00, 54.10s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 15
LOSS: train: 4.513680   ham: 22.525139 |   test: 3.309611  ham: 13.985852
{'net.0.fc.weight_grad': -0.0019138164352625608, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.011137843132019043, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.90s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 64%|████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 16/25 [14:26<08:07, 54.13s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 16
LOSS: train: 5.357451   ham: 28.134958 |   test: 3.824978  ham: 17.374634
{'net.0.fc.weight_grad': -0.0025388908106833696, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.011109053157269955, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  5.01s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 68%|█████████████████████████████████████████████████████████████████████████████████████████████▊                                            | 17/25 [15:20<07:13, 54.22s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 17
LOSS: train: 4.700210   ham: 23.681629 |   test: 4.715847  ham: 23.249775
{'net.0.fc.weight_grad': 0.0019746373873203993, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.011200870387256145, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.87s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 18
LOSS: train: 4.773202   ham: 24.148830 |   test: 3.895095  ham: 17.609854
{'net.0.fc.weight_grad': -0.001779746962711215, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.006846544798463583, 'net.2.attn_fc.weight_grad': 0.0}
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 18/25 [16:13<06:17, 53.92s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.93s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 19
LOSS: train: 4.441694   ham: 21.959454 |   test: 4.479468  ham: 21.602821
{'net.0.fc.weight_grad': 0.0008590253419242799, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.003562853904440999, 'net.2.attn_fc.weight_grad': 0.0}
 76%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 19/25 [17:08<05:23, 53.97s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:48<00:00,  4.90s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                           | 20/25 [18:01<04:29, 53.82s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 20
LOSS: train: 4.028951   ham: 19.250296 |   test: 4.474524  ham: 21.624271
{'net.0.fc.weight_grad': 0.004148381296545267, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.015587742440402508, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.93s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 21/25 [18:55<03:34, 53.74s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 21
LOSS: train: 5.259653   ham: 27.522930 |   test: 5.550047  ham: 28.833344
{'net.0.fc.weight_grad': -0.001431639539077878, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.00939366314560175, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  5.01s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 22/25 [19:49<02:41, 53.91s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 22
LOSS: train: 6.004169   ham: 32.473545 |   test: 4.759623  ham: 23.299498
{'net.0.fc.weight_grad': -0.0029646691400557756, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.009025895036756992, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.98s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 23/25 [20:43<01:48, 54.02s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 23
LOSS: train: 4.850583   ham: 24.690210 |   test: 3.581954  ham: 15.921780
{'net.0.fc.weight_grad': -0.0020798014011234045, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': 0.007933502085506916, 'net.2.attn_fc.weight_grad': 0.0}









100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:49<00:00,  4.98s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍     | 24/25 [21:37<00:54, 54.07s/it]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 24
LOSS: train: 5.248876   ham: 27.269253 |   test: 4.582448  ham: 22.222185
{'net.0.fc.weight_grad': 0.0009813643991947174, 'net.0.attn_fc.weight_grad': 0.0, 'net.2.fc.weight_grad': -0.0023725146893411875, 'net.2.attn_fc.weight_grad': 0.0}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:45,  5.10s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:39,  5.00s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:35,  5.04s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:29,  4.99s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:25<00:25,  5.00s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:29<00:19,  4.96s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:34<00:14,  4.99s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:39<00:09,  4.93s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:44<00:04,  4.91s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 25
LOSS: train: 4.313776   ham: 20.998501 |   test: 4.342759  ham: 20.611326
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
25
torch.Size([128, 15, 1, 13])
15
torch.Size([32, 1, 12])
loading prevoius model
GNN_maker_HNN(
  (net): Sequential(
    (0): GATLayer(
      (fc): Linear(in_features=2, out_features=128, bias=False)
      (attn_fc): Linear(in_features=256, out_features=1, bias=False)
    )
    (1): Tanh()
    (2): GATLayer(
      (fc): Linear(in_features=128, out_features=6, bias=False)
      (attn_fc): Linear(in_features=12, out_features=1, bias=False)
    )
  )
)
TRAIN BATCHES : 10
TEST BATCHES : 1
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:45,  5.08s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:41,  5.18s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:35,  5.14s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:30,  5.15s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:25<00:25,  5.11s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:30<00:20,  5.08s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:35<00:15,  5.10s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:40<00:10,  5.09s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:45<00:05,  5.08s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 1
LOSS: train: 12.101389   ham: 64.045502 |   test: 8.801955  ham: 43.153938
{'net.0.fc.weight_grad': -0.0014731389237567782, 'net.0.attn_fc.weight_grad': 0.05322021245956421, 'net.2.fc.weight_grad': -0.0042912703938782215, 'net.2.attn_fc.weight_grad': -0.09094467759132385}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:47,  5.27s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:42,  5.27s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.22s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:31,  5.28s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:26<00:26,  5.24s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:31<00:21,  5.25s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:36<00:15,  5.22s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:41<00:10,  5.15s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:47<00:05,  5.23s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 2
LOSS: train: 14.051468   ham: 77.535782 |   test: 8.276695  ham: 39.998260
{'net.0.fc.weight_grad': 0.0017658130964264274, 'net.0.attn_fc.weight_grad': 0.011571980081498623, 'net.2.fc.weight_grad': -0.016598084941506386, 'net.2.attn_fc.weight_grad': -0.1228257492184639}
TRAIN
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:47,  5.33s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:41,  5.23s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.23s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:31,  5.19s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:25<00:25,  5.12s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:31<00:20,  5.18s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:36<00:15,  5.17s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:41<00:10,  5.15s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.20s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 3
LOSS: train: 12.797336   ham: 69.356522 |   test: 5.680109  ham: 22.999004
{'net.0.fc.weight_grad': -0.0002845288545358926, 'net.0.attn_fc.weight_grad': 0.004401528742164373, 'net.2.fc.weight_grad': -0.0067016142420470715, 'net.2.attn_fc.weight_grad': -0.05677632614970207}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:46,  5.13s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:40,  5.09s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:35,  5.10s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:30,  5.10s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:25<00:25,  5.19s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:30<00:20,  5.13s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:35<00:15,  5.15s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:41<00:10,  5.14s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.12s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 4
LOSS: train: 13.424945   ham: 73.663307 |   test: 12.993211  ham: 71.803185
{'net.0.fc.weight_grad': 0.00039933910011313856, 'net.0.attn_fc.weight_grad': 0.0026140818372368813, 'net.2.fc.weight_grad': -0.008839844726026058, 'net.2.attn_fc.weight_grad': -0.06130267679691315}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:47,  5.24s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:41,  5.16s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.19s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:30,  5.13s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:25<00:25,  5.17s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:30<00:20,  5.13s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:36<00:15,  5.17s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:41<00:10,  5.13s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.09s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 5
LOSS: train: 12.998627   ham: 70.956062 |   test: 6.744044  ham: 30.282206
{'net.0.fc.weight_grad': 0.00025066197849810123, 'net.0.attn_fc.weight_grad': -0.0015315134078264236, 'net.2.fc.weight_grad': 0.0024510242510586977, 'net.2.attn_fc.weight_grad': -0.02043318748474121}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:46,  5.20s/it]
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:46,  5.20s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:41,  5.17s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.15s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:31,  5.23s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:26<00:26,  5.32s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:31<00:21,  5.30s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:36<00:15,  5.23s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:41<00:10,  5.13s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.18s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 6
LOSS: train: 12.294664   ham: 66.436363 |   test: 7.800221  ham: 37.810452
{'net.0.fc.weight_grad': 0.0031600056681782007, 'net.0.attn_fc.weight_grad': -0.006895551923662424, 'net.2.fc.weight_grad': 0.004935514181852341, 'net.2.attn_fc.weight_grad': -0.05253469571471214}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:47,  5.32s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:41,  5.21s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.26s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:31,  5.20s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:25<00:25,  5.08s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:30<00:20,  5.12s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:35<00:15,  5.09s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:41<00:10,  5.08s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.11s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 7
LOSS: train: 11.344432   ham: 60.335266 |   test: 10.780099  ham: 57.697292
{'net.0.fc.weight_grad': -0.0007144969422370195, 'net.0.attn_fc.weight_grad': 0.014580512419342995, 'net.2.fc.weight_grad': 0.012317925691604614, 'net.2.attn_fc.weight_grad': -0.05384860932826996}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:46,  5.11s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:40,  5.11s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.21s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:31,  5.28s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:26<00:27,  5.49s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:22,  5.52s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.62s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:11,  5.63s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.68s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 8
LOSS: train: 12.667306   ham: 69.116402 |   test: 13.865032  ham: 78.206856
{'net.0.fc.weight_grad': 0.002871667267754674, 'net.0.attn_fc.weight_grad': 0.0001422346686013043, 'net.2.fc.weight_grad': 0.00698276748880744, 'net.2.attn_fc.weight_grad': -0.16607387363910675}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:49,  5.47s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:42,  5.36s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.43s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.46s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.42s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:21,  5.50s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.53s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.46s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:48<00:05,  5.41s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 9
LOSS: train: 11.374510   ham: 60.274952 |   test: 13.078325  ham: 72.547638
{'net.0.fc.weight_grad': 0.0016617323271930218, 'net.0.attn_fc.weight_grad': 0.023836761713027954, 'net.2.fc.weight_grad': 0.01697346568107605, 'net.2.attn_fc.weight_grad': -0.14539138972759247}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:46,  5.18s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:41,  5.21s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.18s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:31,  5.23s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:26<00:26,  5.25s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:31<00:21,  5.31s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:36<00:15,  5.31s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:42<00:10,  5.36s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:47<00:05,  5.38s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 10
LOSS: train: 10.366885   ham: 53.367256 |   test: 10.230016  ham: 53.369308
{'net.0.fc.weight_grad': -0.0015104860067367554, 'net.0.attn_fc.weight_grad': -0.025236913934350014, 'net.2.fc.weight_grad': -0.03005499206483364, 'net.2.attn_fc.weight_grad': -0.13718082010746002}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:45,  5.02s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:09<00:39,  4.99s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:35,  5.09s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:30,  5.07s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:25<00:25,  5.11s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:30<00:20,  5.19s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:36<00:15,  5.26s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:41<00:10,  5.31s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.27s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 11
LOSS: train: 10.914244   ham: 56.940971 |   test: 12.646076  ham: 69.477928
{'net.0.fc.weight_grad': -0.0014060125686228275, 'net.0.attn_fc.weight_grad': -0.02691040001809597, 'net.2.fc.weight_grad': -0.026955604553222656, 'net.2.attn_fc.weight_grad': -0.08580008894205093}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:46,  5.15s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:41,  5.24s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.24s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:31,  5.17s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:26<00:26,  5.25s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:31<00:21,  5.27s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:36<00:15,  5.22s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:41<00:10,  5.21s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.19s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 12
LOSS: train: 10.529519   ham: 54.321785 |   test: 12.811893  ham: 70.769753
{'net.0.fc.weight_grad': -0.0012045986950397491, 'net.0.attn_fc.weight_grad': -0.029216770082712173, 'net.2.fc.weight_grad': -0.024608388543128967, 'net.2.attn_fc.weight_grad': -0.05392715334892273}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:47,  5.23s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:41,  5.14s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.19s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:30,  5.13s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:25<00:25,  5.15s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:30<00:20,  5.11s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:36<00:15,  5.18s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:41<00:10,  5.17s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.13s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 13
LOSS: train: 10.556619   ham: 54.482586 |   test: 12.003281  ham: 65.011726
{'net.0.fc.weight_grad': -0.0018481346778571606, 'net.0.attn_fc.weight_grad': -0.00493659870699048, 'net.2.fc.weight_grad': -0.01446536835283041, 'net.2.attn_fc.weight_grad': -0.035494107753038406}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:45,  5.06s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:40,  5.03s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:35,  5.09s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:31,  5.17s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:25<00:25,  5.15s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:30<00:20,  5.16s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:36<00:15,  5.18s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:41<00:10,  5.13s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:46<00:05,  5.26s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 14
LOSS: train: 10.847326   ham: 56.421947 |   test: 12.055440  ham: 65.530418
{'net.0.fc.weight_grad': 0.004201618954539299, 'net.0.attn_fc.weight_grad': 0.009511616080999374, 'net.2.fc.weight_grad': 0.0204752366989851, 'net.2.attn_fc.weight_grad': -0.04670633003115654}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:46,  5.14s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:40,  5.07s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.17s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:20<00:31,  5.17s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:25<00:26,  5.22s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:31<00:21,  5.26s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:36<00:15,  5.33s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:42<00:10,  5.32s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:47<00:05,  5.25s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 15
LOSS: train: 9.341216   ham: 46.320251 |   test: 7.573109  ham: 35.313820
{'net.0.fc.weight_grad': -0.004396237898617983, 'net.0.attn_fc.weight_grad': -0.024598252028226852, 'net.2.fc.weight_grad': -0.027961529791355133, 'net.2.attn_fc.weight_grad': -0.0553009994328022}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.60s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:42,  5.30s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.21s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:31,  5.22s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:26<00:26,  5.29s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:31<00:21,  5.29s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:37<00:16,  5.37s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:42<00:10,  5.35s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:48<00:05,  5.43s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 16
LOSS: train: 10.375887   ham: 53.288109 |   test: 9.366092  ham: 47.580246
{'net.0.fc.weight_grad': 0.0033955820836126804, 'net.0.attn_fc.weight_grad': 0.017204875126481056, 'net.2.fc.weight_grad': 0.017133068293333054, 'net.2.attn_fc.weight_grad': -0.03146620839834213}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:49,  5.45s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:44,  5.55s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:39,  5.70s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:34,  5.81s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:28<00:28,  5.77s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:34<00:22,  5.66s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:39<00:16,  5.58s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:11,  5.51s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:50<00:05,  5.44s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 17
LOSS: train: 9.462797   ham: 47.181217 |   test: 11.469011  ham: 61.469780
{'net.0.fc.weight_grad': -0.00260534486733377, 'net.0.attn_fc.weight_grad': -0.006106394808739424, 'net.2.fc.weight_grad': -0.014518472366034985, 'net.2.attn_fc.weight_grad': -0.039119821041822433}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:48,  5.36s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:42,  5.28s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:37,  5.36s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.37s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.47s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:22,  5.50s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:37<00:16,  5.41s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:37<00:16,  5.41s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.38s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:48<00:05,  5.35s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 18
LOSS: train: 11.176050   ham: 58.654652 |   test: 12.357079  ham: 67.385803
{'net.0.fc.weight_grad': 0.003691383171826601, 'net.0.attn_fc.weight_grad': 0.007962347008287907, 'net.2.fc.weight_grad': 0.015427851118147373, 'net.2.attn_fc.weight_grad': -0.05117138847708702}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.62s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:44,  5.54s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.57s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.45s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.46s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:21,  5.39s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.53s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.43s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.53s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 19
LOSS: train: 10.568440   ham: 54.499287 |   test: 11.537862  ham: 62.282608
{'net.0.fc.weight_grad': 0.004598547704517841, 'net.0.attn_fc.weight_grad': 0.004704293794929981, 'net.2.fc.weight_grad': 0.01678849384188652, 'net.2.attn_fc.weight_grad': -0.0508255809545517}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:49,  5.50s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:45,  5.73s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:39,  5.65s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.57s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.50s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:21,  5.45s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.37s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.39s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.42s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 20
LOSS: train: 8.999168   ham: 43.985664 |   test: 8.375980  ham: 40.826313
{'net.0.fc.weight_grad': -0.00501428684219718, 'net.0.attn_fc.weight_grad': -0.01790737733244896, 'net.2.fc.weight_grad': -0.0233166441321373, 'net.2.attn_fc.weight_grad': -0.0980425477027893}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:47,  5.31s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:43,  5.42s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:37,  5.37s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.39s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.44s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:21,  5.40s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:37<00:16,  5.38s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.48s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.56s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 21
LOSS: train: 9.784225   ham: 49.322872 |   test: 6.651038  ham: 29.853054
{'net.0.fc.weight_grad': 0.004236212000250816, 'net.0.attn_fc.weight_grad': 0.019053852185606956, 'net.2.fc.weight_grad': 0.014471651054918766, 'net.2.attn_fc.weight_grad': -0.5017656683921814}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:49,  5.48s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:44,  5.56s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.49s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.43s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.42s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:21,  5.37s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:37<00:16,  5.41s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.35s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:48<00:05,  5.33s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 22
LOSS: train: 8.971324   ham: 43.907970 |   test: 10.248091  ham: 53.611099
{'net.0.fc.weight_grad': 0.007688280660659075, 'net.0.attn_fc.weight_grad': -0.005142752546817064, 'net.2.fc.weight_grad': 0.007928178645670414, 'net.2.attn_fc.weight_grad': -0.6738693118095398}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:48,  5.42s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:42,  5.31s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:15<00:36,  5.22s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:31,  5.31s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:26<00:26,  5.30s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:31<00:21,  5.30s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:37<00:16,  5.40s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:42<00:10,  5.39s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:48<00:05,  5.39s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 23
LOSS: train: 9.162156   ham: 45.131176 |   test: 6.058866  ham: 25.413677
{'net.0.fc.weight_grad': 0.006635044701397419, 'net.0.attn_fc.weight_grad': -0.004844998009502888, 'net.2.fc.weight_grad': 0.026813596487045288, 'net.2.attn_fc.weight_grad': -0.19338376820087433}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:49,  5.46s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:42,  5.32s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.50s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.55s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.51s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:22,  5.51s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.47s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.39s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.44s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 24
LOSS: train: 8.408415   ham: 39.683788 |   test: 6.719340  ham: 29.689447
{'net.0.fc.weight_grad': -0.009547844529151917, 'net.0.attn_fc.weight_grad': 0.001898960443213582, 'net.2.fc.weight_grad': -0.04598737135529518, 'net.2.attn_fc.weight_grad': 0.13704796135425568}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.60s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:43,  5.48s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.48s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.40s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:26<00:26,  5.34s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:21,  5.41s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:37<00:16,  5.40s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:37<00:16,  5.40s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.38s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:48<00:05,  5.42s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
Epoch: 25
LOSS: train: 8.908777   ham: 42.847878 |   test: 6.760099  ham: 29.478172
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
25
torch.Size([128, 15, 1, 17])
15
torch.Size([32, 1, 16])
loading prevoius model
GNN_maker_HNN(
  (net): Sequential(
    (0): GATLayer(
      (fc): Linear(in_features=2, out_features=128, bias=False)
      (attn_fc): Linear(in_features=256, out_features=1, bias=False)
    )
    (1): Tanh()
    (2): GATLayer(
      (fc): Linear(in_features=128, out_features=6, bias=False)
      (attn_fc): Linear(in_features=12, out_features=1, bias=False)
    )
  )
)
TRAIN BATCHES : 10
TEST BATCHES : 1
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.56s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:45,  5.63s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:39,  5.65s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.67s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:28<00:28,  5.66s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.69s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:39<00:17,  5.68s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:45<00:11,  5.64s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:50<00:05,  5.67s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:50<00:05,  5.67s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 1
LOSS: train: 9.399546   ham: 42.322609 |   test: 11.227765  ham: 55.506111
{'net.0.fc.weight_grad': 0.007497295271605253, 'net.0.attn_fc.weight_grad': -0.0036312215961515903, 'net.2.fc.weight_grad': 0.05029962956905365, 'net.2.attn_fc.weight_grad': -0.011006500571966171}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:53,  5.91s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:46,  5.79s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:17<00:40,  5.78s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:17<00:40,  5.78s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:34,  5.71s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:28<00:28,  5.77s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:34<00:23,  5.75s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:40<00:17,  5.80s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:46<00:11,  5.75s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:52<00:05,  5.80s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
TEST
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
Epoch: 2
LOSS: train: 9.619935   ham: 43.879021 |   test: 10.445704  ham: 50.145336
{'net.0.fc.weight_grad': -0.008062862791121006, 'net.0.attn_fc.weight_grad': -0.0012759924866259098, 'net.2.fc.weight_grad': -0.053756747394800186, 'net.2.attn_fc.weight_grad': -0.006936791818588972}
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:51,  5.69s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:46,  5.77s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:39,  5.62s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:34,  5.70s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:28<00:28,  5.62s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:28<00:28,  5.62s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:34<00:22,  5.67s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:39<00:16,  5.66s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:45<00:11,  5.71s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:51<00:05,  5.72s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 3
LOSS: train: 7.986238   ham: 32.951042 |   test: 17.072262  ham: 94.266930
{'net.0.fc.weight_grad': -0.008700999431312084, 'net.0.attn_fc.weight_grad': -0.00027229328406974673, 'net.2.fc.weight_grad': -0.05236697569489479, 'net.2.attn_fc.weight_grad': -0.004952806048095226}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:53,  5.94s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:46,  5.78s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:17<00:40,  5.84s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:34,  5.68s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:28<00:28,  5.70s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:34<00:22,  5.63s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:40<00:17,  5.70s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:45<00:11,  5.69s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:51<00:05,  5.73s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 4
LOSS: train: 9.608844   ham: 43.846325 |   test: 17.820242  ham: 99.112701
{'net.0.fc.weight_grad': 0.007056437432765961, 'net.0.attn_fc.weight_grad': -0.0014412824530154467, 'net.2.fc.weight_grad': 0.053959716111421585, 'net.2.attn_fc.weight_grad': -0.010889619588851929}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:51,  5.68s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:45,  5.74s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:17<00:39,  5.70s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:34,  5.74s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:28<00:28,  5.68s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:34<00:22,  5.74s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:40<00:17,  5.77s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:46<00:11,  5.85s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:51<00:05,  5.82s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 5
LOSS: train: 10.368276   ham: 48.938046 |   test: 7.541678  ham: 30.845839
{'net.0.fc.weight_grad': 0.008060619235038757, 'net.0.attn_fc.weight_grad': -0.0007898071780800819, 'net.2.fc.weight_grad': 0.05385083332657814, 'net.2.attn_fc.weight_grad': -0.010438221506774426}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:53,  5.98s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:46,  5.75s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:17<00:40,  5.78s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:23<00:34,  5.73s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:28<00:28,  5.75s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:34<00:22,  5.61s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:39<00:16,  5.59s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:10,  5.49s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:50<00:05,  5.50s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 6
LOSS: train: 8.906641   ham: 39.112816 |   test: 6.410743  ham: 23.277237
{'net.0.fc.weight_grad': 0.006381173152476549, 'net.0.attn_fc.weight_grad': -0.0019599890802055597, 'net.2.fc.weight_grad': 0.01979145035147667, 'net.2.attn_fc.weight_grad': -0.009161565452814102}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:48,  5.36s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:44,  5.52s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.46s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.63s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.55s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.58s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.48s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.48s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:11,  5.51s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.43s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 7
LOSS: train: 9.084493   ham: 40.208305 |   test: 10.032077  ham: 47.075375
{'net.0.fc.weight_grad': -0.01348553504794836, 'net.0.attn_fc.weight_grad': -0.0025522520300000906, 'net.2.fc.weight_grad': -0.062251731753349304, 'net.2.attn_fc.weight_grad': 0.006310399621725082}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.66s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:43,  5.47s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.47s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.53s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.53s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.50s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.55s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:10,  5.48s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.55s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 8
LOSS: train: 10.205724   ham: 47.608177 |   test: 6.626226  ham: 24.589643
{'net.0.fc.weight_grad': -0.006367991678416729, 'net.0.attn_fc.weight_grad': -3.9030739571899176e-05, 'net.2.fc.weight_grad': -0.040127161890268326, 'net.2.attn_fc.weight_grad': -0.003041926072910428}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.60s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:43,  5.50s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.56s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.57s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.53s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.54s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.51s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:10,  5.48s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.57s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 9
LOSS: train: 8.891742   ham: 38.896347 |   test: 9.142462  ham: 41.049995
{'net.0.fc.weight_grad': 0.009525571018457413, 'net.0.attn_fc.weight_grad': 0.0009178467444144189, 'net.2.fc.weight_grad': 0.05297500267624855, 'net.2.attn_fc.weight_grad': -0.023882322013378143}
TRAIN
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:48,  5.34s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:43,  5.47s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.47s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:33,  5.52s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.48s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.53s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.45s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:11,  5.63s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.63s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 10
LOSS: train: 8.514546   ham: 36.475243 |   test: 14.545282  ham: 77.195015
{'net.0.fc.weight_grad': 0.009186194278299809, 'net.0.attn_fc.weight_grad': -0.0007157152285799384, 'net.2.fc.weight_grad': 0.052945781499147415, 'net.2.attn_fc.weight_grad': -0.009595297276973724}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:51,  5.68s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:43,  5.43s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.52s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.46s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.57s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.50s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.58s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:10,  5.48s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.51s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 11
LOSS: train: 10.030244   ham: 46.556263 |   test: 9.348623  ham: 42.573521
{'net.0.fc.weight_grad': -0.012445359490811825, 'net.0.attn_fc.weight_grad': -0.0009958762675523758, 'net.2.fc.weight_grad': -0.05888430401682854, 'net.2.attn_fc.weight_grad': 0.0033741567749530077}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:48,  5.43s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:44,  5.53s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:44,  5.53s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.46s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.53s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.54s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.55s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.46s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.49s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.41s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 12
LOSS: train: 8.595942   ham: 37.007843 |   test: 8.568824  ham: 37.886230
{'net.0.fc.weight_grad': 0.010531021282076836, 'net.0.attn_fc.weight_grad': -0.0006680916994810104, 'net.2.fc.weight_grad': 0.05460614338517189, 'net.2.attn_fc.weight_grad': -0.01366363000124693}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.58s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:44,  5.52s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.49s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.53s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.55s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.56s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.60s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:11,  5.51s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.54s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 13
LOSS: train: 8.246030   ham: 34.606445 |   test: 6.737898  ham: 25.503841
{'net.0.fc.weight_grad': 0.009362795390188694, 'net.0.attn_fc.weight_grad': 0.0002708585234358907, 'net.2.fc.weight_grad': 0.027945978567004204, 'net.2.attn_fc.weight_grad': -0.01618255116045475}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.61s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:44,  5.55s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:39,  5.59s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.57s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.52s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.53s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.48s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:10,  5.47s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.51s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 14
LOSS: train: 8.760105   ham: 37.997547 |   test: 6.958381  ham: 26.895267
{'net.0.fc.weight_grad': -0.009848425164818764, 'net.0.attn_fc.weight_grad': -0.0013138691429048777, 'net.2.fc.weight_grad': -0.04982525482773781, 'net.2.attn_fc.weight_grad': -0.0019557445775717497}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:48,  5.35s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:44,  5.53s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.49s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:33,  5.50s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.46s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.53s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.48s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:11,  5.54s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.53s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 15
LOSS: train: 8.750743   ham: 38.021656 |   test: 8.768124  ham: 38.804615
{'net.0.fc.weight_grad': -0.010209573432803154, 'net.0.attn_fc.weight_grad': -0.0007524404209107161, 'net.2.fc.weight_grad': -0.05465105548501015, 'net.2.attn_fc.weight_grad': 0.0016951957950368524}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.63s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:43,  5.41s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.54s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.46s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.50s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.58s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:39<00:16,  5.65s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:11,  5.51s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:11,  5.51s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.54s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 16
LOSS: train: 8.535693   ham: 36.666821 |   test: 8.049374  ham: 34.231773
{'net.0.fc.weight_grad': 0.007517233490943909, 'net.0.attn_fc.weight_grad': 2.90340612991713e-05, 'net.2.fc.weight_grad': 0.03335976600646973, 'net.2.attn_fc.weight_grad': -0.0030375784263014793}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:48,  5.35s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:43,  5.49s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:37,  5.38s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.44s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.49s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:22,  5.55s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.50s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:11,  5.53s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.47s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 17
LOSS: train: 8.741527   ham: 38.009109 |   test: 12.515621  ham: 63.996185
{'net.0.fc.weight_grad': 0.012573979794979095, 'net.0.attn_fc.weight_grad': -0.0006810345221310854, 'net.2.fc.weight_grad': 0.057485222816467285, 'net.2.attn_fc.weight_grad': -0.013492431491613388}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.61s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:43,  5.44s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:37,  5.42s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.46s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.44s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:21,  5.42s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.51s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.43s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.49s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
Epoch: 18
LOSS: train: 9.790371   ham: 44.937088 |   test: 13.616890  ham: 70.985710
{'net.0.fc.weight_grad': -0.015318455174565315, 'net.0.attn_fc.weight_grad': -0.00021425912564154714, 'net.2.fc.weight_grad': -0.05929534137248993, 'net.2.attn_fc.weight_grad': -0.002211752813309431}
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.59s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:44,  5.51s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.54s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.52s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.49s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.54s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.54s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:11,  5.51s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.54s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.54s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
Epoch: 19
LOSS: train: 9.294786   ham: 41.653427 |   test: 7.887828  ham: 32.902618
{'net.0.fc.weight_grad': 0.013393184170126915, 'net.0.attn_fc.weight_grad': 0.0005135586252436042, 'net.2.fc.weight_grad': 0.05963945761322975, 'net.2.attn_fc.weight_grad': -0.009788486175239086}
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:48,  5.40s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:44,  5.52s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.47s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.52s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.46s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:22,  5.51s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.46s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:11,  5.51s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.49s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.49s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
Epoch: 20
LOSS: train: 8.796705   ham: 38.409470 |   test: 8.590075  ham: 38.087296
{'net.0.fc.weight_grad': 0.011362631805241108, 'net.0.attn_fc.weight_grad': 0.00045536275138147175, 'net.2.fc.weight_grad': 0.053178537636995316, 'net.2.attn_fc.weight_grad': -0.011701078154146671}
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:51,  5.69s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:43,  5.41s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.53s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.48s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.54s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:21,  5.45s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.50s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.46s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.49s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.49s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
Epoch: 21
LOSS: train: 8.439785   ham: 36.081535 |   test: 6.973344  ham: 27.246017
{'net.0.fc.weight_grad': -0.010032533667981625, 'net.0.attn_fc.weight_grad': -0.00021093811665195972, 'net.2.fc.weight_grad': -0.04724357649683952, 'net.2.attn_fc.weight_grad': -0.005383744370192289}
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:48,  5.34s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:44,  5.52s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:37,  5.43s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:34,  5.69s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:28,  5.65s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.64s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.54s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:11,  5.56s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.47s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.47s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
Epoch: 22
LOSS: train: 10.261892   ham: 48.225037 |   test: 7.595377  ham: 31.773094
{'net.0.fc.weight_grad': -0.011201005429029465, 'net.0.attn_fc.weight_grad': 2.7244625016464852e-05, 'net.2.fc.weight_grad': -0.0535975880920887, 'net.2.attn_fc.weight_grad': -0.003260393626987934}
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.59s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:43,  5.44s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:37,  5.41s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.45s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.45s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:21,  5.47s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.51s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.42s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.47s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.47s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
Epoch: 23
LOSS: train: 8.356480   ham: 35.512756 |   test: 8.200651  ham: 34.967716
{'net.0.fc.weight_grad': -0.01212646160274744, 'net.0.attn_fc.weight_grad': 0.00012765197607222944, 'net.2.fc.weight_grad': -0.05345508083701134, 'net.2.attn_fc.weight_grad': 0.017876161262392998}
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:50,  5.63s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:11<00:43,  5.48s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:38,  5.57s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:22<00:33,  5.57s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.54s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:33<00:22,  5.55s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.51s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:44<00:10,  5.48s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.52s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:49<00:05,  5.52s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
Epoch: 24
LOSS: train: 9.878222   ham: 45.604271 |   test: 9.633198  ham: 44.917953
{'net.0.fc.weight_grad': -0.005762393586337566, 'net.0.attn_fc.weight_grad': 8.174960385076702e-06, 'net.2.fc.weight_grad': -0.02893831394612789, 'net.2.attn_fc.weight_grad': 0.018896041437983513}
  0%|                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
 10%|█████████████▉                                                                                                                             | 1/10 [00:05<00:47,  5.33s/it]
 20%|███████████████████████████▊                                                                                                               | 2/10 [00:10<00:43,  5.40s/it]
 30%|█████████████████████████████████████████▋                                                                                                 | 3/10 [00:16<00:37,  5.41s/it]
 40%|███████████████████████████████████████████████████████▌                                                                                   | 4/10 [00:21<00:32,  5.50s/it]
 50%|█████████████████████████████████████████████████████████████████████▌                                                                     | 5/10 [00:27<00:27,  5.46s/it]
 60%|███████████████████████████████████████████████████████████████████████████████████▍                                                       | 6/10 [00:32<00:21,  5.48s/it]
 70%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                         | 7/10 [00:38<00:16,  5.41s/it]
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 8/10 [00:43<00:10,  5.45s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:48<00:05,  5.42s/it]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 9/10 [00:48<00:05,  5.42s/it]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                    | 0/1 [00:00<?, ?it/s]
Epoch: 25
LOSS: train: 9.728787   ham: 44.579590 |   test: 7.860360  ham: 32.888195
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [25:18<00:00, 60.75s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [25:18<00:00, 60.75s/it]